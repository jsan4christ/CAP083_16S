"0","library(corrplot)"
"2","corrplot 0.84 loaded
"
"0","ps1.v1.cst.glom.Species.ra <- prune_samples(sample_sums(ps1.v1.cst.glom.Species.ra) > 0, ps1.v1.cst.glom.Species.ra)"
"0","ps1.v1.cst.glom.Species.ra <- prune_taxa(taxa_sums(ps1.v1.cst.glom.Species.ra) > 0, ps1.v1.cst.glom.Species.ra)"
"0","V1_otu_tab <- data.frame(otu_table(ps1.v1.cst.glom.Species.ra))"
"0","V1_otu_tab1 <- as.data.frame(t(V1_otu_tab))"
"0","V1_otu_tab1$OTU <- rownames(V1_otu_tab1)"
"0","V1_tax_tab <- data.frame(tax_table(ps1.v1.cst.glom.Species.ra))"
"0","V1_tax_tab$OTU <- rownames(V1_tax_tab)"
"0","dataWSpecies <- merge(V1_otu_tab1, V1_tax_tab[, c(""OTU"", ""Species"")], by = ""OTU"")"
"0","dataWSpecies <- dataWSpecies[!duplicated(dataWSpecies$Species), ]"
"0","dataWSpecies <- dataWSpecies[, -1]"
"0","rownames(dataWSpecies) <- dataWSpecies$Species"
"0","t.dataWSpecies <- t(dataWSpecies[, -ncol(dataWSpecies)])"
"0","#View(t.dataWSpecies)"
"0","corrData <- data.frame(sample_data(ps1.v1.cst.glom.Species.ra))"
"0","corrdataSpecies <-  corrData[, c(proInfC)]"
"0","corrdataSpecies <- apply(corrdataSpecies, 2, as.numeric)"
"0","##Plot cytokines with bacteria"
"0","## PCA plot - all cytoekies"
"0","allCytokines <- corrData[, allCytokineColnames]"
"0","allCytokines <- apply(allCytokines, 2, as.numeric)"
"0","t.dataWSpecies <- apply(t.dataWSpecies, 2, as.numeric)"
"0","# Reformat species column names so they are easier to follow"
"0","SpeciesColNames <- colnames(t.dataWSpecies)"
"0","#SpeciesColNamesSplit <- t(data.frame(stri_split_fixed(str = SpeciesColNames, pattern = "" "", n = 2)))"
"0","#SpeciesColNamesFmt <- paste0(substr(SpeciesColNamesSplit[, 1], 1,1),"". "", SpeciesColNamesSplit[, 2])"
"0","#colnames(t.dataWSpecies) <-  SpeciesColNamesFmt"
"0","colnames(t.dataWSpecies) <-  SpeciesColNames"
"0","cyto.all <- cbind(t.dataWSpecies , allCytokines)"
"0","cyto.all <- apply(cyto.all, 2, as.numeric)"
"0","cyto.all.pca <- PCA(scale(cyto.all, center = TRUE, scale = TRUE), scale.unit = FALSE, graph = FALSE)"
"0","cex.before <- par(""cex"")"
"0","par(cex = 0.7)"
"0","corrplot::corrplot(cor(t.dataWSpecies , allCytokines), type=""full"", "
"0","         p.mat = cyto.all.pca$P, sig.level = 0.001, insig = ""blank"", number.font = 4)"
