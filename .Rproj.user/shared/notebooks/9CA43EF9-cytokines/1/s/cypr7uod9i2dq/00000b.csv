"0","# ## Cytokine heatmap of proinflammatory cytokines only"
"0","# dt.ps1.ProCyto <- data.frame(sample_data(ps1.v1.cst.glom.Species.ra)[ ,proInfC])"
"0","# dt.ps1.ProCyto <- apply(dt.ps1.ProCyto, 2, as.numeric)"
"0","# "
"0","# ## Scale data before PCA"
"0","# dt.ps1.ProCyto.scale <- scale(dt.ps1.ProCyto, center = TRUE, scale = TRUE)"
"0","# "
"0","# ##Run PCA"
"0","# dt.ps1.ProCyto.pca <- PCA(dt.ps1.ProCyto.scale, scale.unit = FALSE, graph = FALSE) ##Library FactoMineR"
"0","# "
"0","# ##Extract PC1"
"0","# ProCytoPCs <- data.frame(dt.ps1.ProCyto.pca$ind$coord)"
"0","# #head(ProCytoPCs)"
"0","# "
"0","# dt.ps1.ProCytoPC1 <- cbind(dt.ps1.ProCyto, PC1 = ProCytoPCs$Dim.1)"
"0","# "
"0","# dt.ps1.cst.sd.ProCyto <- cbind(dt.ps1.v1.cst.sample_data, PC1 = ProCytoPCs$Dim.1)"
"0","# ProCytoHeatmapData <- dt.ps1.cst.sd.ProCyto[, c(""CSTs"", ""Trichomoniasis"", ""Gonorrhoea"", ""Chlamydia"", ""HSV.2"", ""Candidiasis"", ""STI"", ""Inflammation"", ""PSA"", ""PC1"")]"
"0","# ProCytoHeatmapData$SampleID <- rownames(ProCytoHeatmapData)"
"0","# "
"0","# dt.ps1.ProCytoPC1.t <- t(dt.ps1.ProCytoPC1)"
"0","# plotHeatmaps(dt.ps1.ProCytoPC1.t, ProCytoHeatmapData,  myAnnotColmns)"
