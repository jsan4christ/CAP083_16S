"0","ids9 <- readRDS(""results/recurredIds.RDS"")"
"0","ps.ids9 <- prune_samples(sample_data(ps2.v1v2v3.f)$ParticipantID %in% ids9, ps2.v1v2v3.f)"
"0","ps.ids9 <- subset_taxa(ps.ids9, !(Species %in% NA | Species == """"))"
"0","ps.ids9 <- prune_samples(sample_sums(ps.ids9) > 0, ps.ids9)"
"0","ps.ids9 <- prune_taxa(taxa_sums(ps.ids9) > 0, ps.ids9)"
"0","#ps.ids9 <- transform_sample_counts(ps.ids9, function(x){x/sum(x)})"
"0","ps.ids9.merged <- merge_less_than_top(ps.ids9, 13)"
"0","ps.ids9.glom <- tax_glom(ps.ids9.merged, taxrank = ""Species"")"
"0","df9 <- psmelt(ps.ids9.glom)"
"0","df9$ParticipantID <- as.character(df9$ParticipantID)"
"0","#df17.collapse <- "
"0","#colourCount = length(unique(df9$Sample))"
"0","#getPalette = colorRampPalette(brewer.pal(11, ""Spectral"")) #display.brewer.all()"
"0","#Bar plot"
"0","#customPalette <- c(""navy blue"", ""cadetblue1"", ""#E41A1C"", ""lime green"", ""yellow"", ""chocolate"", ""yellow green"", ""#576B9A"", ""#3F78B0"", ""violet"", ""#3B889F"", ""#3E8F90"", ""#419681"", ""#449C73"", ""#47A364"")"
"0","#customPalette2 <- c(""Gardnerella vaginalis""=""#E41A1C"", "
"0","                   # ""Lactobacillus crispatus""=""#33cc66"","
"0","                   # ""Lactobacillus iners""=""#ffcc66"", "
"0","                   # ""Lactobacillus jensenii""=""#009966"","
"0","                   # ""Other""=""#996699"")"
"0","p <-  ggplot(df9[order(-df9[,""Abundance""]),],aes_string(x= ""VisitCode"", y=""Abundance"", fill = ""Species"")) +  "
"0","            geom_bar(stat='identity') + "
"0","            scale_fill_manual(values=customPalette) +"
"0","            theme_minimal() + "
"0","            theme(axis.text.x = element_text(angle = 45, hjust = 0),"
"0","              panel.grid.major.x = element_blank() ,"
"0","              panel.grid.major.y = element_line( size=.1, color=""black"" ))"
"0","p"
