"0","set.seed(1985)"
"0"," "
"0","#Shorter names for taxa (instead of sequences)"
"0","full.taxa.names <- taxa_names(ps1.v1)"
"0","my.taxa.names <- data.frame(full.taxa.names, paste0(""Seq"", seq(1:length(full.taxa.names))))"
"0","names(my.taxa.names) <- c(""Taxa"", ""ShortName"")"
"0","taxa_names(ps1.v1) <- my.taxa.names$Taxa "
"0","## Estimate richness"
"0","ps1.v1 <- cestimate_richness(ps1.v1)"
"0","#Agglomerate at species level"
"0","ps1.v1.cst.glom.Species <- tax_glom(ps1.v1, taxrank = ""Species"")"
"0","ps1.v1.cst.glom.Species.ra <- transform_sample_counts(ps1.v1.cst.glom.Species, function(OTU) OTU/sum(OTU))"
"0","## Generate mclust clusters"
"0","#ps1.v1.cst.glom.species.ra <- generate_mclust_csts(ps1.v1.cst.glom.Species.ra, nClusters = 4)"
"0","#Reorganise factors to known CT naming convention"
"0","#sample_data(ps1.v1.cst.glom.Species.ra)$CSTs <- factor(sample_data(ps1.v1.cst.glom.Species.ra)$CSTs, "
"0","#                                                           levels = c(""CST1"", ""CST3"", ""CST4"", ""CST2""), "
"0","#                                                          labels = c(""CST1"", ""CST2"", ""CST3"", ""CST4""))"
"0","#levels(sample_data(ps1.v1.cst.glom.Species.ra)$CSTs)"
"0","#distObj <- phyloseq::distance(ps1.v1.cst.glom.Species.ra, method=""bray"")"
"0","#Mclust Model"
"0","#BIC <- mclustBIC(scale(distObj), G = 4)"
"0","#plot(BIC) #plot bic to see how model was arrived at"
"0","#mclustObj <- Mclust(scale(distObj), x = BIC)"
"0","#mc <- Mclust(samdist)            # Model-based-clustering"
"0","#summary(mclustObj)                 # Print a summary"
"0","#mclustObj$modelName                # Optimal selected model ==> ""VVV"""
"0","#mclustObj$G                        # Optimal number of cluster => 3"
"0","#head(mclustObj$z, 30)              # Probality to belong to a given cluster"
"0","#head(mclustObj$classification, 30) # Cluster assignement of each observation"
"0","#class(mclustObj$classification)"
"0","#mclust.classif <- mclustObj$classification"
"0","#sample_data(ps1.v1.cst.glom.Species.ra)$CSTs <- factor(mclust.classif, levels = unique(sort(mclust.classif)), labels = paste0(""CST"", seq(length(unique(sort(mclust.classif))))))"
"0","#levels(sample_data(ps1.v1.cst.glom.Species.ra)$CSTs)"
"0","#Reorganise factors to known CT naming convention"
"0","#cstLevels <- as.vector(unique(sample_data(ps1.v1.cst.glom.Species.ra)$CSTs))"
"0","#cstLabels <- c(""CST1"", ""CST2"", ""CST3"", ""CST4"")"
"0","#sample_data(ps1.cst.glom.Species)$CSTs <- factor(sample_data(ps1.cst.glom.Species.ra)$CSTs, levels = cstLevels, labels = #cstLabels)"
"0","#levels(sample_data(ps1.cst.glom.Species.ra)$CSTs)"
"0","##Create ordinations"
"0","#Jaccard - Presence absence"
"0","ps1.v1.cst.glom.Species.ra <- prune_samples(sample_sums(ps1.v1.cst.glom.Species.ra) > 0, ps1.v1.cst.glom.Species.ra)"
"0","ps1.v1.cst.glom.Species.ra <- prune_taxa(taxa_sums(ps1.v1.cst.glom.Species.ra) > 0, ps1.v1.cst.glom.Species.ra)"
"0","ord.pcoa.jac <- ordinate(ps1.v1.cst.glom.Species.ra, method = ""PCoA"", distance = ""jaccard"")"
"0","##Bray Curtis - Abundance"
"0","BrayDistMat <- phyloseq::distance(ps1.v1.cst.glom.Species.ra, method = ""bray"")"
"0","ord.pcoa.bray <- ordinate(ps1.v1.cst.glom.Species.ra, method = ""PCoA"", distance = BrayDistMat)"
"0","#Sort by CTS snd Shannon indexes before proceeding"
"0","sample_data(ps1.v1.cst.glom.Species.ra) <- sample_data(ps1.v1.cst.glom.Species.ra)[order(sample_data(ps1.v1.cst.glom.Species.ra)$sim_CST, sample_data(ps1.v1.cst.glom.Species.ra)$ShannonLgT), ]"
