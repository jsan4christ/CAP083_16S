"0","CSTs <- as.character(unique(sample_data(ps1.v1.cst.glom.Species.ra)$sim_subCST))"
"0","taxa.order <- names(sort(taxa_sums(ps1.v1.cst.glom.Species.ra)))"
"0","table(sample_data(ps1.v1.cst.glom.Species.ra)$sim_subCST) ##I-A and II only have two samples and so they will not have heatmaps created. Filter them out."
"1","
"
"1","  I-A "
"1","  I-B "
"1","   II "
"1","III-A "
"1","III-B "
"1"," IV-A "
"1"," IV-B "
"1","    V "
"1","
"
"1","    2 "
"1","   15 "
"1","    2 "
"1","   59 "
"1","   34 "
"1","   36 "
"1","   68 "
"1","    6 "
"1","
"
"0","for(CST in CSTs[-c(7, 8)]) {"
"0","  ps1.v1.cst.glom.Species.ra.top25 <- prune_taxa(names(sort(taxa_sums(ps1.v1.cst.glom.Species.ra), T))[1:25], ps1.v1.cst.glom.Species.ra)"
"0","  ps1.v1.cst.glom.Species.ra.top25 <- prune_samples(sample_data(ps1.v1.cst.glom.Species.ra.top25)$sim_subCST == CST,     ps1.v1.cst.glom.Species.ra.top25)"
"0","  print(plot_heatmap(ps1.v1.cst.glom.Species.ra.top25, taxa.label=""Species"", sample.label = ""SampleID"", taxa.order=taxa.order) + ggtitle(paste(CST)))"
"0","}"
