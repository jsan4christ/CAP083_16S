"0","CSTs <- as.character(unique(sample_data(ps1.v1.cst.glom.Species.ra)$sim_CST))"
"0","taxa.order <- names(sort(taxa_sums(ps1.v1.cst.glom.Species.ra)))"
"0","table(sample_data(ps1.v1.cst.glom.Species.ra)$sim_CST) ## II only has two samples and so they will not have heatmaps created. We cannot generate heatmap so we will exclude it."
"1","
"
"1","   I "
"1","  II "
"1"," III "
"1","IV-A "
"1","IV-B "
"1","   V "
"1","
"
"1","  25 "
"1","   2 "
"1","  96 "
"1","  40 "
"1","  71 "
"1","   6 "
"1","
"
"0","for(CST in CSTs[-c(6)]) {"
"0","  ps1.v1.cst.glom.Species.ra.top25 <- prune_taxa(names(sort(taxa_sums(ps1.v1.cst.glom.Species.ra), T))[1:25], ps1.v1.cst.glom.Species.ra)"
"0","  ps1.v1.cst.glom.Species.ra.top25 <- prune_samples(sample_data(ps1.v1.cst.glom.Species.ra.top25)$sim_CST == CST,     ps1.v1.cst.glom.Species.ra.top25)"
"0","  print(plot_heatmap(ps1.v1.cst.glom.Species.ra.top25, taxa.label=""Species"", sample.label = ""SampleID"", taxa.order=taxa.order) + ggtitle(paste(CST)))"
"0","}"
