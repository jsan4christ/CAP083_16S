"0","## Create dataset of participants followed accross all three visits"
"0","#Extract sample data"
"0","sample.data.ps1 <- data.frame(sample_data(ps1))"
"0","#Get visit 2 and 3 ids"
"0","visit1.ids <- sample.data.ps1 %>% subset(VisitCode == 1000) %>% pull('ParticipantID')"
"0","visit1.ids <- visit1.ids[!visit1.ids %in% c(120117, 120016, 120060, 120221, 120229, 120223, 120010)]"
"0","visit2.ids <- sample.data.ps1 %>% subset(VisitCode == 1020) %>% pull('ParticipantID') "
"0","visit3.ids <- sample.data.ps1 %>% subset(VisitCode == 1030) %>% pull('ParticipantID')"
"0","#IDs of followed samples"
"0","ids.v2.not.in.v1 <-  subset(visit2.ids, !visit2.ids %in% visit1.ids)"
"0","ids.v2.not.in.v3 <-  subset(visit2.ids, !visit2.ids %in% visit3.ids)"
"0","ids.v3.not.in.v1 <-  subset(visit3.ids, !visit3.ids %in% visit1.ids)"
"0","ids.v3.not.in.v2 <-  subset(visit3.ids, !visit3.ids %in% visit2.ids)"
"0","#All missing visit 1 from visit 2 and 3"
"0","ids.missing.visit1  <-  c(ids.v2.not.in.v1, ids.v3.not.in.v1)"
"0","all.missing <- unique(c(ids.missing.visit1, ids.v3.not.in.v2, ids.v2.not.in.v3))"
"0","ids.followed.v2v3 <- unique(c(visit2.ids, visit3.ids))"
"0","#visit 1, 2 and 3 intersections"
"0","v1v2.ids <- unique(subset(sample.data.ps1, ParticipantID %in% visit1.ids & ParticipantID %in% visit2.ids) %>% "
"0","                      pull('ParticipantID'))"
"0","v1v3.ids <- unique(subset(sample.data.ps1, ParticipantID %in% visit1.ids & ParticipantID %in% visit3.ids) %>% "
"0","                      pull('ParticipantID'))"
"0","v2v3.ids <- unique(subset(sample.data.ps1, ParticipantID %in% visit2.ids & ParticipantID %in% visit3.ids) %>% "
"0","                      pull('ParticipantID'))"
"0","##Get dataset with followed samples"
"0","ps2.v1v2v3 <- subset_samples(ps1, (sample_data(ps1)$ParticipantID %in% ids.followed.v2v3 & "
"0","                               !sample_data(ps1)$ParticipantID %in% all.missing))"
"0","ps2.v1v2v3"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 1351 taxa and 168 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 168 samples by 79 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 1351 taxa by 7 taxonomic ranks ]"
"1","
"
"1","phy_tree()    Phylogenetic Tree: [ 1351 tips and 1349 internal nodes ]"
"1","
"
"0","#Samples followed through the 3 times"
"0","ps2.v1v2v3.ids <- unique(sample_data(ps2.v1v2v3)$ParticipantID)"
"0","saveRDS(ps2.v1v2v3.ids, ""results/v1v2v3-ids.txt"")"
"0","sample_data(ps2.v1v2v3)$VisitCode <- factor(sample_data(ps2.v1v2v3)$VisitCode, levels = c(1000, 1020, 1030))"
"0","#IDs present in visit 1, 2 and 3"
"0","ids.followed.v1v2v3 <- unique(sample_data(ps2.v1v2v3)$ParticipantID)"
"0","ids.followed.v1v2v3 <- c(ids.followed.v1v2v3) #Plus non bv ids"
"0","#Draw venn diagram of visit distribution "
"0","draw.triple.venn(area1 = length(visit1.ids), area2 = length(visit2.ids), area3 = length(visit3.ids), n12 = length(v1v2.ids), n23 = length(v2v3.ids), n13 =length(v1v3.ids), n123 = length(ids.followed.v1v2v3), category = c(""Visit1"", ""Visit2"", ""Visit3""), lty = ""blank"", fill = c(""skyblue"", ""pink1"", ""mediumorchid""), cex=2, cat.cex = 2, cat.fontfamily = rep(""serif"", 3))"
"1","(polygon[GRID.polygon.4361], polygon[GRID.polygon.4362], polygon[GRID.polygon.4363], polygon[GRID.polygon.4364], polygon[GRID.polygon.4365], polygon[GRID.polygon.4366], text[GRID.text.4367], text[GRID.text.4368], text[GRID.text.4369], text[GRID.text.4370], text[GRID.text.4371], text[GRID.text.4372], text[GRID.text.4373], text[GRID.text.4374], text[GRID.text.4375], text[GRID.text.4376])"
"1"," "
"1","
"
"0","sample_data(ps2.v1v2v3)$bv.persisted <- 0"
"0","sample_data(ps2.v1v2v3)$bv.recurred  <- 0"
"0","sample_data(ps2.v1v2v3)$bv.cleared   <- 0"
"0","ps2.v1v2v3"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 1351 taxa and 168 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 168 samples by 82 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 1351 taxa by 7 taxonomic ranks ]"
"1","
"
"1","phy_tree()    Phylogenetic Tree: [ 1351 tips and 1349 internal nodes ]"
"1","
"
