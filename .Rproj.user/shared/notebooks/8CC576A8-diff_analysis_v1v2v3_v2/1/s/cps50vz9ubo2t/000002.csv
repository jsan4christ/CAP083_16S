"0","bv.recurred.ids <- (sdv1v2v3[sdv1v2v3$bv.recurred == 1, ])$SampleID"
"0","#ps2.v1v2v3.f.glomSpecies.ra <- tax_glom(ps2.v1v2v3.cst.glom.species.ra, taxrank = ""Species"")"
"0","ps2.recurred.cyto <- subset_samples(ps2.v1v2v3.glom.species.ra, sample_data(ps2.v1v2v3.glom.species.ra)$SampleID %in% bv.recurred.ids)"
"0","ps2.recurred.cyto <- subset_taxa(ps2.recurred.cyto, Species %in% keyTaxa)"
"0","ps2.recurred.cyto <- prune_taxa(taxa_sums(ps2.recurred.cyto) >0, ps2.recurred.cyto)"
"0","taxa_names(ps2.recurred.cyto) <- tax_table(ps2.recurred.cyto)[, ""Species""]"
"0","otu.ps2.recurred.cyto <- data.frame(otu_table(ps2.recurred.cyto))"
"0","# Reformat species column names so they are easier to follow"
"0","#SpeciesColNames <- colnames(otu.ps2.recurred.cyto)"
"0","#SpeciesColNamesSplit <- t(data.frame(stri_split_fixed(str = SpeciesColNames, pattern = ""."", n = 2)))"
"0","#SpeciesColNamesFmt <- paste0(substr(SpeciesColNamesSplit[, 1], 1,1),""."", SpeciesColNamesSplit[, 2])"
"0","#colnames(otu.ps2.recurred.cyto) <-  SpeciesColNamesFmt"
"0","df.ps2.recurred.cyto <- data.frame(sample_data(ps2.recurred.cyto)[, c(sig.cyto.recurred)])"
"0","dt.ps2.recurred.cyto.otu <- cbind(otu.ps2.recurred.cyto, df.ps2.recurred.cyto)"
"0","dt.ps2.recurred.pca <- PCA(scale(as.matrix(dt.ps2.recurred.cyto.otu), center = TRUE, scale = TRUE), scale.unit = FALSE, graph = FALSE)"
"0","fviz_pca_biplot(dt.ps2.recurred.pca,"
"0","             #individuals "
"0","             geom.ind = ""point"", # show points only (but not ""text""),"
"0","             habillage = (data.frame(sample_data(ps2.recurred.cyto)))$sim_subCST,"
"0","             col.var = ""black"", "
"0","             arrowsize=1,"
"0","          "
"0","             #variables"
"0","             alpha.var =  ""cos2"", "
"0","             #addEllipses = TRUE, # Concentration ellipses"
"0","             #ellipse.level=0.95,"
"0","             palette = CSTsPallete,"
"0","             legend.title = ""sim_subCST"","
"0","             title = ""PCA plot Showing the Relationship Between Bacteria and Cytokines in the recurred Category"","
"0","             label = ""var"", "
"0","             repel = TRUE)+"
"0","  scale_color_brewer(palette=""Dark2"")+ "
"0","  theme_minimal(base_size = 14) +"
"0","  theme(text = element_text(face = ""bold""))"
"2","Scale for 'colour' is already present. Adding another scale for 'colour', which will replace the
existing scale.
"
